# 功能詳述

本文檔詳細說明 Deep Agentic AI Tool 的所有功能和使用範例。

## 🔍 深度研究代理 (Deep Research Agent)

### 功能概述

深度研究代理是一個智能多步驟研究系統，能夠自動分解複雜問題、選擇合適的工具、執行研究任務，並生成完整的研究報告。

### 核心特性

1. **智能任務分解**
   - 自動識別查詢類型（學術、股票相關、一般查詢）
   - 根據查詢類型生成適當的任務列表
   - 避免不必要的工具調用

2. **動態工具選擇**
   - 股票查詢工具（yfinance）
   - 網路搜尋工具（Tavily API）
   - PDF 知識庫工具（RAG 系統）

3. **即時進度追蹤**
   - 顯示當前執行的節點
   - 任務完成進度
   - 研究筆記即時更新

4. **流式報告生成**
   - 逐句流式顯示最終報告
   - 支援中英文標點符號
   - 完整的結構化報告

### 使用範例

#### 學術/理論問題

**輸入：**
```
解釋 Tree of Thoughts 並深入比較它與 Chain of Thought
```

**系統處理：**
1. 識別為學術查詢
2. 使用 PDF 知識庫工具檢索相關內容
3. 生成比較分析報告

**輸入：**
```
分析 Tree of Thoughts 方法的優缺點
```

#### 股票相關問題

**輸入：**
```
比較微軟 (MSFT) 和谷歌 (GOOGL) 在 AI 領域的表現
```

**系統處理：**
1. 識別為股票查詢
2. 使用股票查詢工具獲取兩家公司數據
3. 使用網路搜尋工具獲取最新 AI 相關新聞
4. 生成比較分析報告

**輸入：**
```
查詢蘋果 (AAPL) 的財務狀況和近期發展
```

#### 綜合問題

**輸入：**
```
比較微軟 (MSFT) 和谷歌 (GOOGL) 在 AI 領域，並結合 Tree of Thoughts 方法論
```

**系統處理：**
1. 識別為綜合查詢
2. 同時使用股票查詢、網路搜尋和 PDF 知識庫工具
3. 生成綜合分析報告

### 工作流程

1. **規劃節點 (Planner)**
   - 分析查詢並分解為研究任務
   - 生成任務列表

2. **研究代理節點 (Research Agent)**
   - 執行研究任務
   - 動態選擇並調用工具
   - 維護對話上下文

3. **工具節點 (Tools)**
   - 執行工具調用
   - 返回結果

4. **筆記整理節點 (Note Taking)**
   - 整理工具結果
   - 添加到研究筆記

5. **最終報告節點 (Final Report)**
   - 綜合所有研究筆記
   - 生成結構化報告

## 📧 智能郵件助手 (Email Agent)

### 功能概述

智能郵件助手使用 AI 自動生成郵件草稿，支援 Gmail API 發送，並提供 AI 反思評估功能以改進郵件質量。

### 核心特性

1. **AI 自動生成**
   - 根據簡單提示生成完整郵件
   - 支援中英文郵件
   - 自動生成主題和正文

2. **AI 反思評估**
   - 自動評估郵件質量
   - 提供改進建議
   - 可選自動改進（生成改進版本）

3. **Gmail API 整合**
   - 使用官方 API 發送，避免垃圾郵件分類
   - OAuth2 認證，無需儲存密碼
   - 更可靠的錯誤處理

4. **可編輯草稿**
   - 生成後可檢查和修改
   - 確認無誤後發送

### 使用範例

#### 基本使用

**輸入提示：**
```
寫一封感謝信，感謝對方在專案上的幫助
```

**收件人：**
```
colleague@example.com
```

**系統處理：**
1. 生成郵件主題和正文
2. 進行 AI 反思評估
3. 如有改進建議，顯示評估結果
4. 用戶可選擇使用改進版本或原始版本

#### 商務郵件

**輸入提示：**
```
邀請某人參加下週的產品發布會
```

**收件人：**
```
client@example.com
```

#### 進度查詢

**輸入提示：**
```
詢問專案進度並提供更新
```

**收件人：**
```
team@example.com
```

### AI 反思評估

系統會自動評估生成的郵件：

- **完整性**：是否包含所有必要資訊
- **語氣**：是否適合收件人和情境
- **結構**：邏輯是否清晰
- **專業性**：是否符合商務郵件標準

如果評估發現需要改進，系統會：
1. 顯示評估結果和改進建議
2. 可選自動生成改進版本
3. 用戶可選擇使用改進版本或原始版本

### 設置要求

- Gmail API 憑證（參考 [Gmail API 設置](GMAIL_API_SETUP.md)）
- OAuth2 授權（首次使用時自動觸發）

## 📅 智能行事曆管理 (Calendar Agent)

### 功能概述

智能行事曆管理使用 AI 自動生成行事曆事件，整合 Google Calendar API 和 Google Maps，提供地點驗證、交通時間計算等功能。

### 核心特性

1. **AI 自動生成事件**
   - 根據完整提示生成事件
   - 自動解析日期、時間、地點、參與者
   - 支援相對日期（今天、明天、後天）

2. **AI 反思評估與改進**
   - 最多 3 輪迭代反思
   - 自動評估事件完整性
   - 自動生成改進版本

3. **Google Maps 整合**
   - 自動驗證和標準化地址
   - 計算交通時間
   - 建議出發時間

4. **智能缺失資訊處理**
   - 自動檢測缺失資訊（日期、時間）
   - 提供下拉選單供選擇
   - 確認後自動填充

5. **快速選擇按鈕**
   - 團隊會議
   - 客戶拜訪
   - 午餐會議
   - 一對一會議
   - 項目討論
   - 培訓/學習
   - 社交活動
   - 自定義輸入

### 使用範例

#### 基本使用

**輸入提示：**
```
明天下午2點團隊會議，討論專案進度，地點在會議室A
```

**系統處理：**
1. 解析日期：明天
2. 解析時間：下午2點
3. 解析事件：團隊會議
4. 解析地點：會議室A
5. 生成事件草稿
6. 進行 AI 反思評估
7. 驗證地點（如果配置了 Google Maps API）
8. 計算交通時間（如果配置了常用位置）

#### 包含參與者

**輸入提示：**
```
後天上午10點客戶拜訪，地點在台北101，參與者包括 john@example.com 和 mary@example.com
```

**系統處理：**
1. 解析所有資訊
2. 驗證並標準化地址（台北101 → 完整地址）
3. 計算從辦公室到台北101的交通時間
4. 建議出發時間（提前10分鐘到達）

#### 使用快速選擇

1. 點擊快速選擇按鈕（例如："📋 團隊會議"）
2. 系統自動填充提示
3. 點擊「生成事件草稿」
4. 如有缺失資訊，系統會提示選擇

### AI 反思評估

系統會進行最多 3 輪迭代反思：

1. **第一輪評估**
   - 評估事件完整性
   - 檢查是否有缺失資訊
   - 評估事件描述是否清晰

2. **改進生成**
   - 如有改進建議，自動生成改進版本
   - 改進版本會再次評估

3. **迭代優化**
   - 重複評估和改進過程
   - 直到 AI 認為滿意或達到最大迭代次數

### Google Maps 整合

#### 地點驗證

**輸入：**
```
明天下午2點會議，地點在台北101
```

**系統處理：**
1. 驗證地址是否存在
2. 標準化為完整格式：`台北市信義區市府路45號（台北101）`
3. 獲取準確座標

#### 交通時間計算

**前提條件：**
- 配置了 `USER_HOME_ADDRESS` 或 `USER_OFFICE_ADDRESS`
- 配置了 `NORMAL_GOOGLE_MAPS_API_KEY`

**系統處理：**
1. 計算從預設位置到事件地點的距離
2. 根據事件時間計算交通時間
3. 建議出發時間（提前10分鐘到達）

**顯示結果：**
```
✅ 地址已驗證：台北市信義區市府路45號（台北101）
📍 從您的預設位置出發，預計需要 25 分鐘（12.5 公里）
⏰ 建議出發時間：2026-01-26 13:35
```

### 事件管理功能

- **創建事件**：生成並創建新事件
- **更新事件**：修改現有事件（需要事件 ID）
- **刪除事件**：刪除現有事件（需要事件 ID）

### 設置要求

- Google Calendar API 憑證（與 Gmail API 共用）
- Google Maps API 金鑰（可選，用於地點驗證）
- 用戶常用位置（可選，用於交通時間計算）

詳細設置請參考：
- [Gmail API 設置](GMAIL_API_SETUP.md)（Calendar API 設置相同）
- [Google Maps 整合說明](GOOGLE_MAPS_INTEGRATION.md)

## 📊 研究工具集

### 股票查詢工具

**功能：**
- 即時股票數據檢索
- 公司財務數據和營運狀況
- 市值、P/E 比、營收成長
- 業務摘要和分析

**使用範例：**
- 查詢單一股票：`查詢蘋果 (AAPL) 的財務狀況`
- 比較多個股票：`比較微軟 (MSFT) 和谷歌 (GOOGL)`

### 網路搜尋工具

**功能：**
- 使用 Tavily Search API
- 獲取最新新聞和資訊
- 支援多語言搜尋

**使用範例：**
- 搜尋最新資訊：`搜尋 AI 領域的最新發展`
- 獲取新聞：`查找關於 ChatGPT 的最新新聞`

### PDF 知識庫工具

**功能：**
- 向量化語義搜尋
- 目前包含 "Tree of Thoughts" 研究論文
- 可擴展到其他 PDF 文檔

**使用範例：**
- 查詢論文內容：`解釋 Tree of Thoughts 方法`
- 比較概念：`比較 Tree of Thoughts 和 Chain of Thought`

## 🔄 LLM 配置

系統支援多種 LLM 後端，並自動切換：

1. **主要：Groq API**（快速，需要 API 金鑰）
   - 模型：`llama-3.3-70b-versatile`
   - 如果設置了 `GROQ_API_KEY` 則自動使用

2. **備援：本地 MLX 模型**（保護隱私，無需 API 金鑰）
   - 模型：`mlx-community/Qwen2.5-Coder-7B-Instruct-4bit`
   - 當 Groq API 不可用或額度用完時自動使用

系統會根據可用性自動切換後端。

## 💡 使用技巧

1. **研究查詢**
   - 使用具體的問題描述
   - 包含股票代碼（如果查詢股票）
   - 明確指出需要比較的內容

2. **郵件生成**
   - 提供上下文資訊（例如：專案名稱、時間）
   - 指定郵件語氣（正式、友好等）
   - 檢查 AI 反思評估結果

3. **行事曆事件**
   - 使用完整提示（包含所有必要資訊）
   - 使用快速選擇按鈕快速開始
   - 檢查地點驗證和交通時間資訊
   - 如有缺失資訊，使用系統提供的下拉選單

4. **性能優化**
   - 使用 Groq API 獲得更快結果
   - 本地 MLX 模型適合隱私敏感場景
   - 系統會自動選擇最佳後端

